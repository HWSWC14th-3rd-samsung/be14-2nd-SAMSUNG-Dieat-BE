<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.samsung.dieat.diet_post.query.dao.DietPostQueryMapper">

    <!-- 전체 게시글 조회 -->
    <select id="findAll" resultType="com.samsung.dieat.diet_post.query.dto.DietPostResponseDto">
        SELECT *
        FROM tbl_diet_post
        WHERE diet_isdeleted = FALSE
        ORDER BY diet_upload_dt DESC
    </select>

    <!-- 단일 게시글 조회 -->
    <select id="findById" parameterType="int" resultType="com.samsung.dieat.diet_post.query.dto.DietPostResponseDto">
        SELECT *
        FROM tbl_diet_post
        WHERE diet_code = #{dietCode}
          AND diet_isdeleted = FALSE
    </select>

    <!-- 전체 게시글 페이징 조회 -->
    <select id="findAllWithPaging" resultType="com.samsung.dieat.diet_post.query.dto.DietPostListResponseDto">
        SELECT
            diet_code,
            diet_title,
            diet_conts,
            diet_calories,
            diet_view_cnt,
            DATE_FORMAT(diet_upload_dt, '%Y-%m-%d %H:%i:%s') AS diet_upload_dt
        FROM tbl_diet_post
        WHERE diet_isdeleted = false
        ORDER BY diet_upload_dt DESC
            LIMIT #{size} OFFSET #{offset}
    </select>

    <!-- 전체 게시글 수 카운트 -->
    <select id="countAll" resultType="int">
        SELECT COUNT(*) FROM tbl_diet_post WHERE diet_isdeleted = false
    </select>

</mapper>
